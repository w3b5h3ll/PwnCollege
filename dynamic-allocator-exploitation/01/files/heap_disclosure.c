#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <assert.h>

int main()
{
    char *password = malloc(8);
    char *name = malloc(8);
    printf("password address: %p\n", password);
    printf("name address: %p\n", name);

    printf("Password? ");
    scanf("%7s", password);
    assert(strcmp(password, "hunter2") == 0);
    free(password);

    printf("Name? ");
    scanf("%7s", name);
    printf("Hello %s!\n", name);
    free(name);
    printf("name address: %p\n", name);

    printf("Goodbye, %s!\n", name);
    // c0r3dump@Ubuntu24:~/Works/Works/PwnCollege/dynamic-allocator-exploitation/01/files$ ./heap_disclosure
    // password address: 0x5c0bd79452a0
    // name address: 0x5c0bd79452c0
    // Password? hunter2
    // Name? test
    // Hello test!
    // name address: 0x5c0bd79452c0
    // Goodbye, ï¿½+)\!
}