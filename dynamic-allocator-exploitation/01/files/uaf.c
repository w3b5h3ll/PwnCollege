int main()
{
    char *user_input = malloc(8);
    printf("user_input address: %p\n", user_input);

    printf("Name? ");
    scanf("%7s", user_input);
    printf("Hello %s!\n", user_input);
    free(user_input);

    long *authenticated = malloc(8);
    printf("authenticated address: %p\n", authenticated);
    *authenticated = 0;

    printf("Password? ");
    // 最多读取7个字符
    scanf("%7s", user_input);

    printf("\nUid: %d\n", getuid());
    printf("user_input: %s\n", user_input);

    printf("authenticated: %s\n", authenticated);

    memset(authenticated, 0, 8 * sizeof(long)); // 清空 authenticated 的内容
    printf("authenticated: %s\n", authenticated);

    if (getuid() == 0 || strcmp(user_input, "hunter2") == 0)
        *authenticated = 1;
    if (*authenticated)
        sendfile(0, open("./flag", 0), 0, 128);

    // Name? test
    // Hello test!
    // Password? *****

    // Uid: 1000
    // user_input: *****
    // authenticated: *****
    // flag{flag is here!}
    // 可以看到authenticated被覆盖了,即原来free'd user_input的内存被覆盖了

    // user_input address: 0x5a79b6f0c2a0
    // Name? test
    // Hello test!
    // authenticated address: 0x5a79b6f0c2a0
    // Password? test

    // Uid: 1000
    // user_input: test
    // authenticated: test
    // flag{flag is here!}
}